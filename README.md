# Hoare Logic for Type Checking

## Core Syntax

![Core Syntax](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%20%20%5Ctext%7BLifetime%2C%20%7D%20%5Ckappa%20%3A%3A%3D%20%26%20%5Ctextbf%7Bstatic%7D%20%5Cmid%20%5Calpha%20%5C%5C%0A%20%20%20%20%5Ctext%7BAccess%20Modifier%2C%20%7D%20%5Cmu%20%3A%3A%3D%20%26%20%5Ctextbf%7Bmut%7D%20%5Cmid%20%5Ctextbf%7Bshr%7D%20%5C%5C%0A%20%20%20%20%5Ctext%7BL-Value%2C%20%7D%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%20%3A%3A%3D%20%26%20x%20%5Cmid%20*%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%5C%5C%0A%20%20%20%20%5Ctext%7BValue%2C%20%7D%20v%20%3A%3A%3D%20%26%20z%20%5Cmid%20true%20%5Cmid%20false%20%5Cmid%20%5Cell%20%5C%5C%0A%20%20%20%20%5Ctext%7BType%7D%20%5Cni%20%5Ctau%20%3A%3A%3D%20%26%20%5Ctextbf%7Bbool%7D%20%5Cmid%20%5Ctextbf%7Bint%7D%20%5Cmid%20%5Csquare%20%5C%3B%20%5Ctau%0A%20%20%20%20%20%20%20%20%5Cmid%20%5C%26%5E%7B%5Cmu%7D%20%5Ctau%20%5Cmid%20%5Clangle%20%5Ctau%20%5Crangle%5E%7B%5Ckappa%7D%20%5Cmid%20%28%29%20%5C%5C%0A%20%20%20%20%5Ctext%7BLifetime%20Context%2C%20%7D%20%5CPsi%20%3A%3A%3D%20%26%20%28%5Cmathcal%7BL%7D%2C%20%5Cpreceq%29%20%5C%5C%0A%20%20%20%20%5Ctext%7BExpression%7D%20%5Cni%20e%20%3A%3A%3D%20%26%5C%3A%20v%20%5Cmid%20%5Ctext%7Blet%20mut%20%7D%20x%20%3D%20e%0A%20%20%20%20%20%20%20%20%5Cmid%20%5Ctext%7Bmove%20%7D%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%20%5Cmid%20%5Ctext%7Bcopy%20%7D%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%20%20%5C%5C%0A%20%20%20%20%20%20%20%20%26%20%5Cmid%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%20%3D%20e%20%5Cmid%20%5Ctext%7Bbox%20%7D%20e%20%5Cmid%20%5C%26%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%20%5Cmid%20%5C%26%20%5Ctext%7Bmut%20%7D%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%20%5C%5C%0A%20%20%20%20%20%20%20%20%26%20%5Cmid%20%5Ctext%7BendLifetime%20%7D%20x%20%5C%5C%0A%20%20%20%20%20%20%20%20%26%20%5Cmid%20e_1%20%2B%20e_2%20%5Cmid%20e_1%20-%20e_2%0A%20%20%20%20%20%20%20%20%5Cmid%20e_1%20%5Cleq%20e_2%20%5Cmid%20e_1%20%3D%3D%20e_2%20%20%5C%5C%0A%20%20%20%20%20%20%20%20%26%5Cmid%20%5C%7B%20e_1%3B%20e_2%3B%20...%3B%20e_n%20%5C%7D%0A%5Cend%7Balign*%7D)

## Hoare Forward Rules

### Basic Rules

![Int Rule](https://latex.codecogs.com/png.latex?%5Cfrac%7B%7D%7B%5C%7B%20%5CPsi%2C%20%5CDelta%20%5C%7D%20%5C%3B%20z%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br%5D%7B%20%5CPsi%2C%20%5CDelta%20%5Cland%20r%3A%5Cmathbf%7Bint%7D%7D%5C%7D%7D%20%5Cquad%20%5Ctext%7B%28int%29%7D)

![True Rule](https://latex.codecogs.com/png.latex?%5Cfrac%7B%7D%7B%5C%7B%20%5CPsi%2C%20%5CDelta%20%5C%7D%20%5C%3B%20true%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br%5D%7B%20%5CPsi%2C%20%5CDelta%20%5Cland%20r%3A%5Cmathbf%7Bbool%7D%7D%5C%7D%7D%20%5Cquad%20%5Ctext%7B%28true%29%7D)

![False Rule](https://latex.codecogs.com/png.latex?%5Cfrac%7B%7D%7B%5C%7B%20%5CPsi%2C%20%5CDelta%20%5C%7D%20%5C%3B%20false%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br%5D%7B%20%5CPsi%2C%20%5CDelta%20%5Cland%20r%3A%5Cmathbf%7Bbool%7D%7D%5C%7D%7D%20%5Cquad%20%5Ctext%7B%28false%29%7D)

### Box Rule

![Box Rule](https://latex.codecogs.com/png.latex?%5Cfrac%7B%5C%7B%20%5CPsi%2C%20%5CDelta%20%5C%7D%20%5C%3B%20e%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br_1%5D%7B%20%5CPsi%2C%20%5CDelta%20%5Cland%20r_1%3A%5Ctau%7D%5C%7D%7D%7B%5C%7B%20%5CPsi%2C%20%5CDelta%20%5C%7D%20%5C%3B%20%5Ctext%7Bbox%20%7D%20e%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br_2%5D%7B%20%5CPsi%2C%20%5CDelta%20%5Cland%20r_2%3A%5Csquare%20%5C%3B%20%5Ctau%20%7D%5C%7D%7D%20%5Cquad%20%5Ctext%7B%28box%29%7D)

### Lifetime Rules

![Let Create Lifetime](https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Ctextit%7Bfresh%20%7D%20%5Ctexttt%7B%27a%7D%20%5Cquad%20%5C%7B%20%5CPsi%2C%20%5CDelta%20%5C%7D%20%5C%3B%20e%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br_1%5D%7B%20%5CPsi%2C%20%5CDelta%20%5Cland%20r_1%20%3A%20%5Ctau%20%7D%5C%7D%20%5Cquad%20%5Cneg%20%5Ctext%7BRefType%7D%20%28%5Ctau%29%20%5Cquad%20%5CPsi_1%20%5Cequiv%20%28%5Cmathcal%7BL%7D%20%5Ccup%20%5C%7B%20%5Ctexttt%7B%27a%7D%20%5C%7D%2C%20%5Cpreceq%29%7D%7B%5C%7B%20%28%5Cmathcal%7BL%7D%2C%20%5Cpreceq%29%2C%20%5CDelta%20%5C%7D%20%5C%3B%20%5Ctext%7Blet%20mut%20%7D%20x%20%3D%20e%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br_2%5D%7B%20%5CPsi_1%2C%20%5CDelta%20%5Cland%20x%3A%20%5Clangle%20%5Ctau%20%5Crangle%5E%7B%5Ctexttt%7B%27a%7D%7D%20%5Cland%20r_2%20%3A%20%28%29%20%7D%5C%7D%7D%20%5Cquad%20%5Ctext%7B%28let-create-lifetime%29%7D)

![Let Propagate Lifetime](https://latex.codecogs.com/png.latex?%5Cfrac%7B%5C%7B%20%5CPsi%2C%20%5CDelta%20%5C%7D%20%5C%3B%20e%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br_1%5D%7B%20%5CPsi_1%2C%20%5CDelta_1%20%7D%5C%7D%7D%7B%5C%7B%5CPsi%2C%20%5CDelta%20%5C%7D%20%5C%3B%20%5Ctext%7Blet%20mut%20%7D%20x%20%3D%20e%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br_2%5D%7B%20%5CPsi_1%2C%20%5Br_1%20%3A%3D%20x%5D%5CDelta_1%20%5Cland%20r_2%20%3A%20%28%29%20%7D%5C%7D%7D%20%5Cquad%20%5Ctext%7B%28let-propagate-lifetime%29%7D)

### Dereferencing Rule

![Dereference](https://latex.codecogs.com/png.latex?%5Cfrac%7B%5CDelta%20%5Cvdash%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%20%3A%20%5Clangle%20%5Csquare%20%5C%3B%20%5Ctau%20%5Crangle%5E%7B%5Ctexttt%7B%27a%7D%7D%20%5Clor%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%20%3A%20%5Clangle%20%5C%26%5E%7B%5Cmu%7D%20%5Ctau%20%5Crangle%5E%7B%5Ctexttt%7B%27a%7D%7D%7D%7B%5CDelta%20%5Cvdash%20*%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%20%3A%20%5Clangle%20%5Ctau%20%5Crangle%5E%7B%5Ctexttt%7B%27a%7D%7D%7D%20%5Cquad%20%5Ctext%7B%28de-reference%29%7D)

### End Lifetime Rule

![End Lifetime](https://latex.codecogs.com/png.latex?%5Cfrac%7B%5CDelta%20%5Cvdash%20x%3A%20%5Clangle%20%5Ctau%20%5Crangle%5E%7B%5Ctexttt%7B%27a%7D%7D%20%5Cquad%20%5Ctexttt%7B%27a%7D%20%5Cin%20%5Cmathcal%7BL%7D%20%5Cquad%20%5CPsi_1%20%5Cequiv%20%28%5Cmathcal%7BL%7D%20%5Csetminus%20%5C%7B%20%5Ctexttt%7B%27a%7D%20%5C%7D%2C%20%5Cpreceq%29%7D%7B%5C%7B%20%28%5Cmathcal%7BL%7D%2C%20%5Cpreceq%29%2C%20%5CDelta%20%5C%7D%20%5C%3B%20%5Ctext%7BendLifetime%20%7D%20%7Bx%7D%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br%5D%7B%20%5CPsi_1%2C%20%5CDelta%20%5Cland%20r%3A%28%29%7D%20%5C%7D%7D%20%5Cquad%20%5Ctext%7B%28endlifetime%29%7D)

### Move Rule

![Move](https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Ctextit%7Bfresh%20%7D%20%5Ctexttt%7B%27b%7D%20%5Cquad%20%5Cneg%20%5Ctext%7BreadProhibited%7D%28%5CPsi%2C%20%5CDelta%2C%20x%2C%20%5Ctexttt%7B%27a%7D%29%20%5Cquad%20%5CPsi_1%20%5Cequiv%20%28%28%5Cmathcal%7BL%7D%20%5Csetminus%20%5C%7B%20%5Ctexttt%7B%27a%7D%20%5C%7D%29%20%5Ccup%20%5C%7B%20%5Ctexttt%7B%27b%7D%20%5C%7D%2C%20%5Cpreceq%29%7D%7B%5C%7B%20%28%5Cmathcal%7BL%7D%2C%20%5Cpreceq%29%2C%20%5CDelta%20%5C%7D%20%5C%3B%20%5Ctext%7Bmove%20%7D%20x%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br%5D%7B%20%5CPsi_1%2C%20%5CDelta%20%5Cland%20r%3A%20%5Clangle%20%5Ctau%20%5Crangle%5E%7B%5Ctexttt%7B%27b%7D%7D%20%7D%5C%7D%7D%20%5Cquad%20%5Ctext%7B%28move%29%7D)

### Borrow Rules

![Immutable Borrow](https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Ctextit%7Bfresh%20%7D%20%5Ctexttt%7B%27b%7D%20%5Cquad%20%5CDelta%20%5Cvdash%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%3A%20%5Clangle%20%5Ctau%20%5Crangle%5E%7B%5Ctexttt%7B%27a%7D%7D%20%5Cquad%20%5Cneg%20%5Ctext%7BreadProhibited%7D%28%5CPsi%2C%20%5CDelta%2C%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%2C%20%5Ctexttt%7B%27a%7D%29%20%5Cquad%20%5CPsi_1%20%5Cequiv%20%28%5Cmathcal%7BL%7D%20%5Ccup%20%5C%7B%20%5Ctexttt%7B%27b%7D%20%5C%7D%2C%20%5Cpreceq%20%5Ccup%20%5C%7B%20%28%5Ctexttt%7B%27a%2C%20%27b%7D%29%20%5C%7D%29%7D%7B%5C%7B%20%28%5Cmathcal%7BL%7D%2C%20%5Cpreceq%29%2C%20%5CDelta%20%5C%7D%20%5C%3B%20%5C%26%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br%5D%7B%20%5CPsi_1%2C%20%5CDelta%20%5Cland%20r%3A%20%5Clangle%20%5C%26%5E%7B%5Ctextbf%7Bshr%7D%7D%20%5Ctau%20%5Crangle%5E%7B%5Ctexttt%7B%27b%7D%7D%7D%20%5C%7D%7D%20%5Cquad%20%5Ctext%7B%28shr-borrow%29%7D)

![Mutable Borrow](https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Ctextit%7Bfresh%20%7D%20%5Ctexttt%7B%27b%7D%20%5Cquad%20%5CDelta%20%5Cvdash%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%3A%20%5Clangle%20%5Ctau%20%5Crangle%5E%7B%5Ctexttt%7B%27a%7D%7D%20%5Cquad%20%5Cneg%20%5Ctext%7BwriteProhibited%7D%28%5CPsi%2C%20%5CDelta%2C%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%2C%20%5Ctexttt%7B%27a%7D%29%20%5Cquad%20%5CPsi_1%20%5Cequiv%20%28%5Cmathcal%7BL%7D%20%5Ccup%20%5C%7B%20%5Ctexttt%7B%27b%7D%20%5C%7D%2C%20%5Cpreceq%20%5Ccup%20%5C%7B%20%28%5Ctexttt%7B%27a%2C%20%27b%7D%29%20%5C%7D%29%7D%7B%5C%7B%20%28%5Cmathcal%7BL%7D%2C%20%5Cpreceq%29%2C%20%5CDelta%20%5C%7D%20%5C%3B%20%5C%26%5Ctext%7Bmut%20%7D%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br%5D%7B%20%5CPsi_1%2C%20%5CDelta%20%5Cland%20r%3A%20%5Clangle%20%5C%26%5E%7B%5Ctextbf%7Bmut%7D%7D%20%5Ctau%20%5Crangle%5E%7B%5Ctexttt%7B%27b%7D%7D%7D%20%5C%7D%7D%20%5Cquad%20%5Ctext%7B%28mutable-borrow%29%7D)

### Assignment Rule

![Assignment](https://latex.codecogs.com/png.latex?%5Cfrac%7B%5CDelta%20%5Cvdash%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%3A%20%5Clangle%20%5Ctau%20%5Crangle%5E%7Ba%7D%20%5Cquad%20%5C%7B%20%5CPsi%2C%20%5CDelta%20%5C%7D%20%5C%3B%20e%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br_1%5D%7B%20%5CPsi%2C%20%5CDelta%20%5Cland%20r_1%3A%5Ctau%7D%5C%7D%20%5Cquad%20%5Cneg%20%5Ctext%7BwriteProhibited%7D%28%5CPsi%2C%20%5CDelta%2C%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%2C%20a%29%7D%7B%5C%7B%20%28%5Cmathcal%7BL%7D%2C%20%5Cpreceq%29%2C%20%5CDelta%20%5C%7D%20%5C%3B%20%5Coverset%7B%5Cleftharpoonup%7D%7Bv%7D%20%3D%20e%20%5C%3B%20%5C%7B%20%5Ctextbf%7Bens%7D%5Br_2%5D%7B%20%5CPsi%2C%20%5CDelta%20%5Cland%20r_2%3A%28%29%20%7D%5C%7D%7D%20%5Cquad%20%5Ctext%7B%28assignment%29%7D)
